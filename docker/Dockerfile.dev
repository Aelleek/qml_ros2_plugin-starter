FROM ros:humble

# 빌드 도구 + colcon + Qt5 QML 런처
RUN apt-get update && apt-get install -y \
    build-essential cmake git python3-colcon-common-extensions \
    # Qt5 dev + QML 런타임 모듈
    qtbase5-dev qtdeclarative5-dev qtdeclarative5-dev-tools \
    qml-module-qtquick-controls qml-module-qtquick-controls2 \
    qml-module-qtquick-layouts qml-module-qtgraphicaleffects \
    # Qt5 Multimedia + GStreamer
    qtmultimedia5-dev qml-module-qtmultimedia \
    libqt5multimedia5 libqt5multimedia5-plugins \
    gstreamer1.0-tools gstreamer1.0-libav \
    gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad \
    # ROS deps (앞서 필요했던 것들)
    ros-humble-image-transport \
    ros-humble-cv-bridge \
    ros-humble-tf2-ros \
    ros-humble-ros-babel-fish \
    ros-humble-ros-babel-fish-test-msgs \
    ros-humble-example-interfaces \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /ws
SHELL ["/bin/bash", "-lc"]

# ROS 환경 자동 로드(컨테이너 로그인 시)
RUN echo "source /opt/ros/humble/setup.bash" >> /root/.bashrc
